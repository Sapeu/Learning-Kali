# 漏洞映射

> 漏洞映射旨在识别和分析目标环境中的决定性安全缺陷，有时也称为脆弱性评估。它是一种在IT基础设施的安全控制中探寻已知弱点的分析方法，是脆弱性管理计划的一个关键组成部分。，测试人员在完成了信息收集、目标识别和服务枚举的相关工作后，就可着手分析目标设施中可能存在的安全漏洞。安全漏洞可能导致目标系统发生事故，有害于业务系统的保密性、完整性和可用性。
>> - 漏洞的常见类型：本地漏洞和远程漏洞

## Cisco 工具分析

### Cisco Auditing Tool

> 小型的安全审计工具，可以检测出Cisco路由器上的常见漏洞，能够发现注入默认密码、默认SNMP字符串和老版本IOS上存在的BUG问题。

```shell
# -h 指定主机名（在扫描单个主机的时候使用该选项）
# -w 指定字典文件（以猜测团体字符串）
# -a 指定密码列表（以穷举密码）
# -i 及[ioshist]（检查该IOS在历史上出现过的BUG）
CAT -h ww.xx.yy.zz -w lists/community -a lists/passwords -i
```

### Cisco Global Exploiter

> CGE是小型的Perl脚本程序，可以测试Cisco设备的14种独立的漏洞，只有指定类型的Cisco设备才会存在这些漏洞

```shell
cge.pl ww.xx.yy.zz
```

## Fuzz（模糊）分析工具

> 模糊分析是一种软件测试技术。审计人员和开发人员采用模糊分析技术，测试意外数据、无效数据和随机的数据输入对应用程序的影响。这种测试技术可深度揭露软件所隐含的其他测试手段不可能挖掘出来的漏洞。它能发现的漏洞有缓冲区溢出、格式化字符串、代码注入、迷途指针、竞争条件、拒绝服务攻击和许多其他类型的漏洞。

### Bruteforce Exploit Detector

> BED是纯文本的模糊测试工具。可以检测出缓存区溢出漏洞、格式化字符串漏洞、整数溢出、DoS条件等漏洞。BED程序可以根据指定的协议，自动发送含有问题字符串的命令组合，以测试目标的处理方式。目前包括ftp、smtp、pop、http、irc、imap、pjl、lpd、finger、socks4和socks5

```shell
bed.pl -s <plugin> -t <target> -p <port> -o <timeout> [ depends on the plugin ]

# <plugin>   = FTP/SMTP/POP/HTTP/IRC/IMAP/PJL/LPD/FINGER/SOCKS4/SOCKS5
# <target>   = Host to check (default: localhost)
# <port>     = Port to connect to (default: standard port)
# <timeout>  = seconds to wait after each test (default: 2 seconds)

bed -s FTP -u username -v password -t 192.168.56.101 -p 21 -o 3
```

### JBroFuzz

> JBroFuzz是对web应用程序进行模糊测试的著名平台。它可模拟HTTP协议和HTTPS协议的web请求。获取要测试的域名和测试的URL部分之后，审计人员可以自己手工构造测试的请求。也可以使用程序预定义的payload数据库，生成基于已知漏洞的恶意请求，再把这些请求发送到目标服务器以进行模糊测试。JBroFuzz的数据库能够帮助审计人员进行XSS、SQL注入、缓冲区溢出、格式化字符串错误等问题的自动化测试。而后，程序会记录目标的相应回复，以供进一步检查。基于执行测试的类型，审计人员应当手动调查服务器 的响应和结果，以便识别出任何可能存在的漏洞。

> JBroFuzz的关键功能包括模糊管理、payload的分类处理、通过浏览器的代理服务器嗅探web请求和回复、美剧万丈目录等。

```shell
# 启动JBroFuzz程序
cd /usr/share/zaproxy/lib
java -jar JBroFuzz.jar
```

## SMB分析工具

> Server Message Block protocol(SMB)是应用层协议，通常用于文件和打印机服务。

### ImpacketSamrdump

> Samrdump是获取主机敏感信息的工具。它通过DCE/RPC服务调用SAM（安全账户管理器）的远程接口，继而获取信息。它可列举同意局域网内的目标主机上的所有的系统共享，用户账户和其他信息

```shell
cd /usr/share/doc/python-impacket/examples
python samrdump.py

# 检测指定目标的指定端口
python samrdump.py user:pass@ip port/SMB
```

# Kali配置

1. 更换软件源 编辑/etc/apt/sources.list

    - 默认源

    --- 
        deb http://http.kali.org/kali kali-rolling main contrib non-free
        deb-src http://http.kali.org/kali kali-rolling main contrib non-free

    - 中科大Kali源

    ---
        deb http://mirrors.ustc.edu.cn/kali kali-rolling main contrib non-free
        deb-src http://mirrors.ustc.edu.cn/kali kali-rolling main contrib non-free

    - 阿里Kali源

    ---
        deb http://mirrors.aliyun.com/kali kali-rolling main contrib non-free
        deb-src http://mirrors.aliyun.com/kali kali-rolling main contrib non-free

2. gnome桌面设置

```shell
gsettings set org.gnome.desktop.session session-name gnome #这个模式比较流畅
gsettings set org.gnome.desktop.session session-name gnome-fallback #还原默认模式
gnome-shell –replace #在默认模式临时开启
```

> 设置gnome扩展
> 只能用火狐打开[GNOME shell extensions](https://extensions.gnome.org)安装和管理gnome程序

- Alternatetab 增强`Alt+tab`用的，可以在切换程序的显示图标,缩略图
- Applications menu + Places status indicator 左上角应用程序菜单和位置
- Auto move windows 设置打开程序的默认的工作区
- Frippery move clock 移动时钟到右边
- Lunar calendar 农历,需要依赖`typelib-1_0-LunarDate-2_0`或者`gir1.2-lunar-date-2.0`
- Mmod panel 1：可以将图标放在面板上2：修改面板，图标的大小 3：设置时钟的位置 4：设置面板的位置 5：设置面板是否隐藏
- Media player indicator 在状态栏控制媒体播放
- Native window placement 让overview下程序的显示更加紧凑一些
- Openweather 天气
- Removable drive menu 打个比方：插上U盘，面板上就会显示一个图标，可以打开U盘，或者弹出
- Taskbar 任务栏
- User themes 想要装shell 主题，就得先装这货
- Window list 面板，显示打开的应用的面板
- Windownavigator 让你在overview 下方便，紧紧通过键盘就可以轻松实现工作区，程序的准确切换

> 设置gonme主题
> [gnome主题](https://www.gnome-look.org/)
> 下载的若是安装程序,安装即可,压缩文件的话,看文档
> 主题压缩文件的话,看文档,解压到对应/usr/share/themes或者个人目录下~/.themes
> 图标压缩文件的话,看文档,解压到对应/usr/share/icons或者个人目录下~/.icons

- 自用GTK3主题-[OSX-Arc-Collection](https://www.gnome-look.org/p/1167049/)
  ![OSX-Arc-Collection](https://cn.pling.com/img/5/9/0/2/287ff414e65c196dfa008ca4ffe2d76d6d35.png)

- 自用鼠标图标-[Capitaine Cursors](https://www.gnome-look.org/p/1148692/)
  ![Capitaine Cursors](https://cn.pling.com/img/9/7/a/5/84b855075d1e843ead31a9fdb98b437868df.png)
  
- 自用程序图标-[La Capitaine](https://www.gnome-look.org/p/1148695/)
  ![](https://cn.pling.com/img/7/1/f/4/bc749b8b5db82372db85825279c2049362c5.png)

3. Kali-linux设置vpn代理

```shell
apt-get install network-manager-openvpn-gnome
apt-get install network-manager-pptp
apt-get install network-manager-pptp-gnome
apt-get install network-manager-strongswan
apt-get install network-manager-vpnc
apt-get install network-manager-vpnc-gnome
/etc/init.d/network-manager restart5
```

4. 启动终端快捷键

> 系统
>> 设置
>>> 快捷键 
>>>>添加如下命令：`gnome-terminal`然后设置 快捷启动终端的键（ctrl+alt+T）

5. 配置java

```shell
gedit /etc/profile  # 最末尾添加
export JAVA_HOME=/usr/lib/jdk/jdk1.7.0_03
export JRE_HOME=/usr/lib/jdk/jdk1.7.0_03/jre 
export PATH=$JAVA_HOME/bin:$JAVA_HOME/jre/bin:$PATH  
export CLASSPATH=$CLASSPATH:.:$JAVA_HOME/lib:$JAVA_HOME/jre/lib
```

6. 配置Git

```shell
ssh-keygen -t rsa -C "xxxx@email.com"
git config --global user.name "xxxx"
git config --global user.email "xxxx@email.com"
```

7. 添加用户

```shell
useradd -m xxx
passwd xxx
usermod -a -G sudo xxx
chsh -s /bin/bash xxx
```

8. 安装和删除软件

```shell
apt-get install git
apt-get install fcitx fcitx-googlepinyin #输入法
apt-get install iceweasel-l10n-zh-cn #汉化浏览器
apt-get install gnome-tweak-tool #安装gnome管理软件
apt-get install synaptic  #安装新立德
apt-get install file-roller #安装解压缩软件
apt-get install clementine  #clementine音乐播放器
apt-get install smplayer #安装smplayer视频播放器
apt-get install  gdebi #有了这个安装软件就不用在终端中dpkg -i安装了，提供图形化软件安装方式
apt-get install nautilus-open-terminal #鼠标右键在当前目录打开终端
apt-get install flashplugin-nonfree #浏览器flash插件
apt-get install terminator #安装多窗口终端
apt-get install google-chrome-stable  #chrome浏览器
apt-get install libreoffice okular #安装libreoffce、pdf文档阅读器
apt-get install lxde-core lxde kali-defaults kali-root-login desktop-base #安装LXDE
apt-get install kali-defaults kali-root-login desktop-base kde-plasma-desktop # 安装KDE

# 删除软件
# 一、如果你知道要删除软件的具体名称，可以使用               =
sudo apt-get remove --purge 软件名称  
sudo apt-get autoremove --purge 软件名称 
# 二、如果不知道要删除软件的具体名称，可以使用
dpkg --get-selections | grep #软件相关名称
sudo apt-get purge #一个带core的package，如果没有带core的package，则是情况而定。
#清理残留数据
dpkg -l |grep ^rc|awk '{print $2}' |sudo xargs dpkg -P 
apt-get remove lxde-core lxde # 删除LXDE
apt-get remove kde-plasma-desktop kde-plasma-desktop kde-standard # 删除KDE
```

9. 显卡

来源: http://www.jianshu.com/p/cd6363aff94e

- 禁止加载开源驱动nouveau （不是必须做的，后面安装时也会提示）

```bash
# 在/etc/modprobe.d/nvidia-installer-disable-nouveau.conf文件中（不存在则新建）加入：
# generated by nvidia-installer
blacklist nouveau
options nouveau modeset=0
```

- 安装内核头文件

```bash
sudo apt-get install -y linux-headers-$(uname -r)
```

- 安装nvidia驱动相关的包

```bash
sudo apt-get install  nvidia-kernel-dkms nvidia-cuda-toolkit nvidia-driver
```

- 添加当前用户到bumblebee用户组(好像安装的时候就执行了)

```bash
adduser $USER bumblebee
```

- 修改bumblebee配置

```bash
# 修改/etc/bumblebee/bumblebee.conf
Driver=nvidia
# 修改/etc/bumblebee/xorg.conf.nvidia
# 在Section "Device"中添加PCI ID，
BusID "PCI:01:00:0"
# 这个值通过lspci | grep VGA得到，将01:00.0修改为01:00:0
#> 00:02.0 VGA compatible controller: Intel Corporation 2nd Generation Core Processor Family Integrated Graphics Controller (rev 09)
#> 01:00.0 VGA compatible controller: NVIDIA Corporation GF108M [GeForce GT 550M] (rev ff)
```

- 检查X11配置

正常情况下不需要存在xorg.conf
如果存在`/etc/X11/xorg.conf`，可以先尝试重启，如果无法重启到桌面环境，则删除该文件。

- 检查和使用

1 首先要可以进入桌面环境
2 `lspci |grep VGA`的输出中，对应独立显卡的那天记录已`rev ff`结尾，表示独立显卡以关闭
3 运行glxgears 查看帧数，然后`optirun glxgears`一般使用独立显卡时，帧数有较大提高。
4 使用独显的过程中，`lsmod |grep nvidia`应该会有输出信息
5 默认使用集显，在需要独显时，通过`optirun`来运行

- 打开和关闭独显

```bash
tee /proc/acpi/bbswitch <<<OFF # 关闭独立显卡
tee /proc/acpi/bbswitch <<<ON  # 开启独立显卡
```

- 卸载

```bash
sudo apt-get purge nvidia* bumblebee* prime*
# 如果还通过nvidia官方的驱动进行过安装，可以运行
./NVIDIA*.run --uninstall
```